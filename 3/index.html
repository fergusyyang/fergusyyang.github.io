<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CS180 Project 3 — Image Warping, Mosaics, and Auto-Stitching</title>
  <meta name="description" content="CS180 Project 3: homographies, rectification, mosaics, and automatic panorama stitching." />

  <style>
    :root{
      --bg:#0b0c10;
      --text:#e8eaf0;
      --muted:#a9afc3;
      --border:rgba(255,255,255,.10);
      --shadow:0 10px 30px rgba(0,0,0,.35);
      --radius:18px;
      --radius2:22px;
      --maxw:1100px;
      --accent:#7aa2ff;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:
        radial-gradient(900px 500px at 20% -10%, rgba(122,162,255,.18), transparent 55%),
        radial-gradient(700px 480px at 85% 10%, rgba(200,120,255,.14), transparent 55%),
        var(--bg);
      color:var(--text);
      font:16px/1.55 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
    }
    a{color:inherit;text-decoration:none}
    a:hover{text-decoration:underline}
    .container{width:min(var(--maxw),calc(100% - 40px));margin:0 auto}

    .site-header{
      position:sticky;top:0;z-index:20;
      backdrop-filter:blur(10px);
      background:rgba(11,12,16,.65);
      border-bottom:1px solid var(--border);
    }
    .header-inner{
      display:flex;align-items:center;justify-content:space-between;gap:16px;
      padding:14px 0;
    }
    .brand{display:flex;align-items:center;gap:12px;min-width:260px}
    .brand-mark{
      width:12px;height:12px;border-radius:999px;
      background:linear-gradient(135deg,var(--accent),#d7a4ff);
      box-shadow:0 0 0 6px rgba(122,162,255,.12);
    }
    .brand-text .title{font-weight:700;letter-spacing:.2px}
    .brand-text .subtitle{color:var(--muted);font-size:.92rem;margin-top:2px}

    .nav{display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:flex-end}
    .nav a{
      padding:8px 10px;border:1px solid transparent;border-radius:999px;color:var(--muted);
    }
    .nav a:hover{color:var(--text);border-color:var(--border);text-decoration:none}

    .hero{padding:42px 0 22px}
    .hero-inner{display:grid;grid-template-columns:1.2fr .8fr;gap:18px;align-items:start}
    .hero h1{
      margin:0 0 10px;
      font-size:clamp(1.6rem,1.2rem + 1.2vw,2.3rem);
      line-height:1.2;
    }
    .hero p{color:var(--muted);margin:0}
    .chips{display:flex;flex-wrap:wrap;gap:10px;margin-top:14px}
    .chip{
      font-size:.86rem;padding:7px 10px;border-radius:999px;
      border:1px solid var(--border);background:rgba(255,255,255,.03);
    }

    .section{padding:26px 0 24px}
    .section h2{margin:0 0 12px;font-size:1.55rem}
    .section h3{margin:18px 0 10px;font-size:1.15rem;color:#eef0f8}
    .section-head{display:flex;align-items:flex-end;justify-content:space-between;gap:14px;margin-bottom:6px}
    .muted{color:var(--muted)}

    .grid{display:grid;gap:14px}
    .grid.one{grid-template-columns:1fr}
    .grid.two{grid-template-columns:repeat(2,minmax(0,1fr))}
    .grid.three{grid-template-columns:repeat(3,minmax(0,1fr))}

    .card{
      border:1px solid var(--border);border-radius:var(--radius);
      background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.015));
      box-shadow:var(--shadow);overflow:hidden;
    }
    .card-header{padding:14px 14px 0}
    .card-title{font-weight:700;letter-spacing:.2px}
    .card-subtitle{color:var(--muted);font-size:.92rem;margin-top:4px}
    .card-content{padding:12px 14px 14px}

    figure.media{margin:0}
    figure.media img{
      width:100%;height:auto;display:block;background:#07080c;cursor:zoom-in;
    }
    figure.media figcaption{
      padding:10px 12px 12px;color:var(--muted);font-size:.92rem;
      border-top:1px solid var(--border);background:rgba(0,0,0,.10);
    }

    .checklist{margin:8px 0 0;padding-left:18px;color:var(--muted)}
    .checklist li{margin:6px 0}
    .steps,.bullets{margin:10px 0 0;padding-left:18px;color:var(--muted)}
    .steps li,.bullets li{margin:6px 0}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
    pre.code{
      margin:10px 0 0;padding:12px;background:rgba(0,0,0,.22);
      border:1px solid var(--border);border-radius:14px;overflow-x:auto;
      color:#d7dbef;font-size:.92rem;
    }

    .callout{
      margin-top:18px;border:1px solid rgba(122,162,255,.28);
      background:rgba(122,162,255,.07);border-radius:var(--radius2);padding:14px;
    }
    .callout-title{font-weight:800;margin-bottom:6px}
    .callout-body{color:var(--muted)}

    .site-footer{
      border-top:1px solid var(--border);
      padding:16px 0;margin-top:18px;background:rgba(0,0,0,.18);
    }
    .footer-inner{display:flex;justify-content:space-between;align-items:center;gap:12px}
    .to-top{
      color:var(--muted);padding:8px 10px;border:1px solid var(--border);border-radius:999px;
    }
    .to-top:hover{color:var(--text);text-decoration:none}

    /* Lightbox */
    .lightbox{position:fixed;inset:0;display:none;z-index:50}
    .lightbox.open{display:block}
    .lightbox-backdrop{position:absolute;inset:0;background:rgba(0,0,0,.70)}
    .lightbox-inner{
      position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
      width:min(1100px,calc(100% - 24px));max-height:calc(100% - 24px);
      background:rgba(17,19,26,.95);border:1px solid var(--border);
      border-radius:18px;box-shadow:0 20px 60px rgba(0,0,0,.55);
      padding:14px;display:flex;flex-direction:column;gap:10px;
    }
    .lightbox-img{
      width:100%;height:auto;max-height:calc(100vh - 180px);
      object-fit:contain;border-radius:12px;background:#07080c;
    }
    .lightbox-caption{color:var(--muted);font-size:.95rem;padding:0 4px 2px}
    .lightbox-close{
      position:absolute;top:10px;right:10px;width:40px;height:40px;border-radius:999px;
      border:1px solid var(--border);background:rgba(0,0,0,.35);
      color:var(--text);font-size:22px;cursor:pointer;
    }
    .lightbox-close:hover{background:rgba(255,255,255,.08)}

    @media (max-width:960px){.hero-inner{grid-template-columns:1fr}}
    @media (max-width:820px){
      .grid.two{grid-template-columns:1fr}
      .grid.three{grid-template-columns:1fr}
      .brand{min-width:unset}
      .nav{justify-content:flex-start}
    }
  </style>
</head>

<body>
  <header class="site-header" id="top">
    <div class="container header-inner">
      <div class="brand">
        <div class="brand-mark" aria-hidden="true"></div>
        <div class="brand-text">
          <div class="title">CS180 Project 3</div>
          <div class="subtitle">Image Warping, Mosaics, and Auto-Stitching</div>
        </div>
      </div>
      <nav class="nav">
        <a href="#overview">Overview</a>
        <a href="#part-a">Part A</a>
        <a href="#part-b">Part B</a>
        <a href="#extras">Extra Credit</a>
      </nav>
    </div>
  </header>

  <main>
    <section class="hero">
      <div class="container hero-inner">
        <div class="hero-copy">
          <h1>Homographies → Rectification → Mosaics → Auto-Stitching</h1>
          <p>
            This project builds a panorama pipeline from scratch. In Part A, I compute a projective transform
            (homography) from clicked correspondences, warp images with different interpolation methods, rectify
            planar surfaces, and create three mosaics with blending. In Part B, I replace manual clicks with an
            automatic pipeline using Harris corners, ANMS, patch descriptors, feature matching, and RANSAC.
          </p>
          <div class="chips">
            <span class="chip">Least-squares homography</span>
            <span class="chip">Inverse warping</span>
            <span class="chip">Feather blending</span>
            <span class="chip">Harris + ANMS</span>
            <span class="chip">RANSAC</span>
          </div>
        </div>

        <div class="hero-card card">
          <div class="card-header">
            <div class="card-title">Deliverables at a glance</div>
            <div class="card-subtitle">All images are clickable (lightbox)</div>
          </div>
          <div class="card-content">
            <ul class="checklist">
              <li>3 manual mosaics (Sets 1–3)</li>
              <li>Interpolation comparison (NN vs bilinear)</li>
              <li>2 rectifications</li>
              <li>Automatic mosaics + comparisons</li>
              <li>Extra credit: cylindrical mosaic + rotation-invariant descriptors</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <section class="section" id="overview">
      <div class="container">
        <h2>Overview</h2>
        <div class="grid two">
          <div class="card">
            <div class="card-header">
              <div class="card-title">Homography model</div>
              <div class="card-subtitle">Projective transform between two views</div>
            </div>
            <div class="card-content">
              <p>
                A homography maps points between two images of the same planar scene (or between images taken from
                the same center of projection under rotation). Using point correspondences
                (x, y) ↔ (u, v), I solve a linear system <span class="mono">Ah = b</span> with
                <span class="mono">h33 = 1</span> using least squares, then warp via inverse mapping.
              </p>
              <pre class="code">Given (x, y) → (u, v):
u = (h11 x + h12 y + h13) / (h31 x + h32 y + 1)
v = (h21 x + h22 y + h23) / (h31 x + h32 y + 1)</pre>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-title">Automatic pipeline</div>
              <div class="card-subtitle">No manual clicks in Part B</div>
            </div>
            <div class="card-content">
              <ol class="steps">
                <li>Harris corners → corner response map</li>
                <li>ANMS → keep strong, well-spread corners</li>
                <li>Descriptors → normalized 8×8 patches from 40×40 windows</li>
                <li>Matching → SSD + Lowe ratio test</li>
                <li>RANSAC → robust homography from inlier matches</li>
                <li>Warp + blend → panorama</li>
              </ol>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ===================== PART A ===================== -->
    <section class="section" id="part-a">
      <div class="container">
        <div class="section-head">
          <h2>Part A — Manual Warping & Mosaics</h2>
          <p class="muted">Input photos were captured with a fixed center of projection and small camera rotations.</p>
        </div>

        <h3>1.1 Source Photo Sets</h3>
        <div class="grid three">
          <figure class="card media">
            <img src="./images/img9_1.1_sources_set1.png" alt="Set 1 source images" data-lightbox />
            <figcaption>Set 1 source images (img1–img2)</figcaption>
          </figure>
          <figure class="card media">
            <img src="./images/img10_1.1_sources_set2.png" alt="Set 2 source images" data-lightbox />
            <figcaption>Set 2 source images (img3–img5)</figcaption>
          </figure>
          <figure class="card media">
            <img src="./images/img11_1.1_sources_set3.png" alt="Set 3 source images" data-lightbox />
            <figcaption>Set 3 source images (img6–img8)</figcaption>
          </figure>
        </div>

        <h3>1.2 Recovering Homographies from Clicked Correspondences</h3>
        <div class="grid two">
          <figure class="card media">
            <img src="./images/img12_1.2_correspondences_set1.png" alt="Clicked correspondences (Set 1)" data-lightbox />
            <figcaption>Clicked correspondences for Set 1 (10 pairs)</figcaption>
          </figure>
          <div class="card">
            <div class="card-header">
              <div class="card-title">Notes</div>
              <div class="card-subtitle">What makes correspondences good?</div>
            </div>
            <div class="card-content">
              <ul class="bullets">
                <li>Choose high-contrast, repeatable points (corners, intersections, sign edges).</li>
                <li>Spread points across the overlap region to avoid unstable fits.</li>
                <li>Use more than 4 points and solve with least squares for robustness.</li>
              </ul>
            </div>
          </div>
        </div>

        <h3>1.3 Interpolation Comparison (Nearest Neighbor vs Bilinear)</h3>
        <div class="grid one">
          <figure class="card media">
            <img src="./images/img13_1.3_interp_nn_vs_bilinear.png" alt="Interpolation comparison" data-lightbox />
            <figcaption>NN vs Bilinear: bilinear reduces jagged edges/aliasing but is slightly slower.</figcaption>
          </figure>
        </div>

        <h3>1.3 Rectification (2 examples)</h3>
        <div class="grid two">
          <figure class="card media">
            <img src="./images/img14_1.3_rectification1_before_after.png" alt="Rectification example 1" data-lightbox />
            <figcaption>Rectification 1 (4 corner clicks → fronto-parallel)</figcaption>
          </figure>
          <figure class="card media">
            <img src="./images/img15_1.3_rectification2_before_after.png" alt="Rectification example 2" data-lightbox />
            <figcaption>Rectification 2 (4 corner clicks → fronto-parallel)</figcaption>
          </figure>
        </div>

        <h3>1.4 Three Mosaics (Feather Blending)</h3>
        <p class="muted">
          I compute a canvas big enough to contain all warped images, then blend using distance-to-border
          feather weights (softly favors pixels away from each image’s boundary).
        </p>
        <div class="grid three">
          <figure class="card media">
            <img src="./images/img16_1.4_mosaic1_set1.png" alt="Mosaic set 1" data-lightbox />
            <figcaption>Mosaic 1 (Set 1)</figcaption>
          </figure>
          <figure class="card media">
            <img src="./images/img17_1.4_mosaic2_set2.png" alt="Mosaic set 2" data-lightbox />
            <figcaption>Mosaic 2 (Set 2)</figcaption>
          </figure>
          <figure class="card media">
            <img src="./images/img18_1.4_mosaic3_set3.png" alt="Mosaic set 3" data-lightbox />
            <figcaption>Mosaic 3 (Set 3)</figcaption>
          </figure>
        </div>
      </div>
    </section>

    <!-- ===================== PART B ===================== -->
    <section class="section" id="part-b">
      <div class="container">
        <div class="section-head">
          <h2>Part B — Automatic Stitching</h2>
          <p class="muted">Replace manual clicks with feature detection, matching, and robust homography estimation.</p>
        </div>

        <h3>2.1 Harris Corners + ANMS</h3>
        <div class="grid two">
          <figure class="card media">
            <img src="./images/img21_2.1_harris_raw_img1.png" alt="Harris corners raw" data-lightbox />
            <figcaption>Raw Harris corners (top responses)</figcaption>
          </figure>
          <figure class="card media">
            <img src="./images/img22_2.1_harris_anms_img1.png" alt="Harris corners after ANMS" data-lightbox />
            <figcaption>After ANMS: fewer clusters, more uniform spatial coverage</figcaption>
          </figure>
        </div>

        <h3>2.2 Descriptors</h3>
        <div class="grid two">
          <figure class="card media">
            <img src="./images/img23_2.2_descriptor_samples.png" alt="8x8 descriptor samples" data-lightbox />
            <figcaption>Sample normalized 8×8 descriptors (from blurred 40×40 patches)</figcaption>
          </figure>
          <div class="card">
            <div class="card-header">
              <div class="card-title">Descriptor design</div>
              <div class="card-subtitle">Simple, fast, and effective</div>
            </div>
            <div class="card-content">
              <ul class="bullets">
                <li>Extract a 40×40 window around each ANMS corner.</li>
                <li>Blur → downsample to 8×8 → flatten.</li>
                <li>Normalize (subtract mean, divide by std) for lighting invariance.</li>
              </ul>
            </div>
          </div>
        </div>

        <h3>2.3 Feature Matching + 2.4 RANSAC Inliers</h3>
        <div class="grid two">
          <figure class="card media">
            <img src="./images/img24_2.3_matches_img2_to_img1.png" alt="Matches before RANSAC" data-lightbox />
            <figcaption>Matches before RANSAC (ratio test applied)</figcaption>
          </figure>
          <figure class="card media">
            <img src="./images/img25_2.4_inlier_matches_img2_to_img1.png" alt="Inlier matches after RANSAC" data-lightbox />
            <figcaption>Inlier matches after RANSAC (outliers removed)</figcaption>
          </figure>
        </div>

        <h3>2.4 Manual vs Automatic Results</h3>
        <div class="grid one">
          <figure class="card media">
            <img src="./images/img26_2.4_manual_vs_auto_set1.png" alt="Manual vs automatic set 1" data-lightbox />
            <figcaption>Set 1: manual vs automatic panorama</figcaption>
          </figure>
          <figure class="card media">
            <img src="./images/img27_2.4_manual_vs_auto_set2.png" alt="Manual vs automatic set 2" data-lightbox />
            <figcaption>Set 2: manual vs automatic panorama</figcaption>
          </figure>
          <figure class="card media">
            <img src="./images/img28_2.4_manual_vs_auto_set3.png" alt="Manual vs automatic set 3" data-lightbox />
            <figcaption>Set 3: manual vs automatic panorama</figcaption>
          </figure>
        </div>
      </div>
    </section>

    <!-- ===================== EXTRAS ===================== -->
    <section class="section" id="extras">
      <div class="container">
        <div class="section-head">
          <h2>Extra Credit</h2>
          <p class="muted">Cylindrical projection (A.5) and rotation-invariant descriptors (B.5).</p>
        </div>

        <h3>1.5 Cylindrical Projection</h3>
        <div class="grid two">
          <figure class="card media">
            <img src="./images/img19_1.5_cyl_inputs_setX.png" alt="Cylindrical inputs" data-lightbox />
            <figcaption>Cylindrical-warped inputs (visualizing the projection)</figcaption>
          </figure>
          <figure class="card media">
            <img src="./images/img20_1.5_cyl_mosaic.png" alt="Cylindrical mosaic" data-lightbox />
            <figcaption>Cylindrical mosaic result</figcaption>
          </figure>
        </div>

        <h3>2.5 Rotation-Invariant Descriptors</h3>
        <div class="grid two">
          <figure class="card media">
            <img src="./images/img32_2.5_b5_rotinv_auto_mosaic_set2.png" alt="Rotation-invariant auto mosaic" data-lightbox />
            <figcaption>Auto mosaic using rotation-invariant descriptor variant</figcaption>
          </figure>

          <div class="card">
            <div class="card-header">
              <div class="card-title">What changed?</div>
              <div class="card-subtitle">Canonical orientation before describing</div>
            </div>
            <div class="card-content">
              <p>
                For each 40×40 patch, I estimate a dominant gradient orientation, rotate the patch to a canonical
                frame, then compute the same normalized 8×8 descriptor. This improves robustness when the scene
                contains rotated viewpoints or tilted features.
              </p>
              <ul class="bullets">
                <li>Gradient histogram → peak orientation</li>
                <li>Rotate patch (bilinear sampling)</li>
                <li>Blur → downsample → normalize</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="callout">
          <div class="callout-title">How to reproduce</div>
          <div class="callout-body">
            Run the Colab notebook cells in order. For Part A, click correspondences when prompted.
            For Part B, just run the pipeline cells; the mosaics are produced automatically.
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container footer-inner">
      <div class="muted">CS180 • Project 3 • Image Warping & Mosaicing</div>
      <a class="to-top" href="#top">Back to top ↑</a>
    </div>
  </footer>

  <!-- Lightbox modal -->
  <div class="lightbox" id="lightbox" aria-hidden="true">
    <div class="lightbox-backdrop" data-close></div>
    <div class="lightbox-inner" role="dialog" aria-modal="true" aria-label="Image viewer">
      <button class="lightbox-close" type="button" data-close aria-label="Close">×</button>
      <img class="lightbox-img" id="lightboxImg" alt="" />
      <div class="lightbox-caption" id="lightboxCaption"></div>
    </div>
  </div>

  <script>
    // Simple lightbox for images with [data-lightbox]
    (function () {
      const lb = document.getElementById("lightbox");
      const lbImg = document.getElementById("lightboxImg");
      const lbCap = document.getElementById("lightboxCaption");

      function openLightbox(src, alt, caption) {
        lbImg.src = src;
        lbImg.alt = alt || "";
        lbCap.textContent = caption || "";
        lb.classList.add("open");
        lb.setAttribute("aria-hidden", "false");
        document.body.style.overflow = "hidden";
      }

      function closeLightbox() {
        lb.classList.remove("open");
        lb.setAttribute("aria-hidden", "true");
        lbImg.src = "";
        lbCap.textContent = "";
        document.body.style.overflow = "";
      }

      document.querySelectorAll("img[data-lightbox]").forEach((img) => {
        img.addEventListener("click", () => {
          const fig = img.closest("figure");
          const cap = fig ? fig.querySelector("figcaption")?.textContent : "";
          openLightbox(img.getAttribute("src"), img.getAttribute("alt"), cap);
        });
      });

      lb.querySelectorAll("[data-close]").forEach((el) => {
        el.addEventListener("click", closeLightbox);
      });

      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") closeLightbox();
      });
    })();
  </script>
</body>
</html>
